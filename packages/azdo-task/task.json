{
  "$schema": "https://raw.githubusercontent.com/Microsoft/azure-pipelines-task-lib/master/tasks.schema.json",
  "id": "e91b4815-8c09-45d9-9f97-b4b5e1e5c4f2",
  "name": "ExtensionTasks",
  "friendlyName": "Azure DevOps Extension Tasks",
  "description": "Package, publish, and manage Azure DevOps extensions and Visual Studio Marketplace extensions",
  "helpMarkDown": "[More Information](https://github.com/jessehouwing/azure-devops-extension-tasks)",
  "category": "Package",
  "author": "Jesse Houwing",
  "version": {
    "Major": 6,
    "Minor": 0,
    "Patch": 0
  },
  "instanceNameFormat": "Extension: $(operation)",
  "demands": [],
  "minimumAgentVersion": "2.144.0",
  "groups": [
    {
      "name": "authentication",
      "displayName": "Authentication",
      "isExpanded": true
    },
    {
      "name": "extensionIdentity",
      "displayName": "Extension Identity",
      "isExpanded": true
    },
    {
      "name": "manifest",
      "displayName": "Manifest Options",
      "isExpanded": false
    },
    {
      "name": "vsix",
      "displayName": "VSIX Options",
      "isExpanded": false
    },
    {
      "name": "overrides",
      "displayName": "Extension Overrides",
      "isExpanded": false
    },
    {
      "name": "publish",
      "displayName": "Publish Options",
      "isExpanded": false
    },
    {
      "name": "sharing",
      "displayName": "Sharing Options",
      "isExpanded": false
    },
    {
      "name": "validation",
      "displayName": "Validation Options",
      "isExpanded": false
    },
    {
      "name": "advanced",
      "displayName": "Advanced",
      "isExpanded": false
    }
  ],
  "inputs": [
    {
      "name": "operation",
      "type": "pickList",
      "label": "Operation",
      "defaultValue": "package",
      "required": true,
      "helpMarkDown": "**Operation to perform:**\n\n- **Package**: Create a .vsix package file from manifest\n- **Publish**: Publish extension to Visual Studio Marketplace\n- **Unpublish**: Remove extension from marketplace\n- **Share**: Share private extension with specific organizations\n- **Unshare**: Unshare extension from organizations\n- **Install**: Install extension to Azure DevOps organizations\n- **Show**: Query and display extension metadata\n- **QueryVersion**: Query latest extension version and optionally increment it\n- **Wait for Validation**: Wait for extension validation to complete\n- **Wait for Installation**: Wait for tasks to be available after installation",
      "options": {
        "package": "Package - Create .vsix file",
        "publish": "Publish - Publish to marketplace",
        "unpublish": "Unpublish - Remove from marketplace",
        "share": "Share - Share with organizations",
        "unshare": "Unshare - Unshare from organizations",
        "install": "Install - Install to organizations",
        "show": "Show - Query extension metadata",
        "QueryVersion": "QueryVersion - Query extension version",
        "waitForValidation": "Wait for Validation - Wait for validation",
        "waitForInstallation": "Wait for Installation - Wait for task availability"
      }
    },
    {
      "name": "connectionType",
      "type": "pickList",
      "label": "Connection Type",
      "required": true,
      "helpMarkDown": "**Authentication method** for marketplace operations:\n\n- **Visual Studio Team Services (PAT)**: Use Personal Access Token (recommended for most users)\n- **Azure Resource Manager (OIDC)**: Use workload identity federation with Azure CLI (no secrets needed, requires Azure RM service connection)\n- **Generic (Basic Auth)**: Use username/password authentication (for on-premises TFS/Azure DevOps Server)\n\n**Note**: Package operation does not require authentication.",
      "visibleRule": "operation != package",
      "groupName": "authentication",
      "options": {
        "connectedService:VsTeam": "Visual Studio Team Services (PAT)",
        "connectedService:AzureRM": "Azure Resource Manager (OIDC)",
        "connectedService:Generic": "Generic (Basic Auth)"
      },
      "defaultValue": "connectedService:VsTeam"
    },
    {
      "name": "connectionName",
      "type": "connectedService:VsTeam",
      "label": "Service Connection",
      "required": true,
      "helpMarkDown": "**Visual Studio Team Services service connection** configured with a Personal Access Token (PAT).\n\n**Required scopes**: Marketplace (Publish)\n\nCreate a PAT at: https://dev.azure.com/_usersSettings/tokens",
      "visibleRule": "operation != package && connectionType = connectedService:VsTeam",
      "groupName": "authentication"
    },
    {
      "name": "connectionNameAzureRM",
      "type": "connectedService:AzureRM",
      "label": "Azure RM Connection",
      "required": true,
      "helpMarkDown": "**Azure Resource Manager service connection** using workload identity federation (OIDC).\n\n**Benefits**: No secrets or PAT tokens needed - uses federated Azure credentials\n\n**Required**: Connection must have access to Visual Studio Marketplace scope (`499b84ac-1321-427f-aa17-267ca6975798`)",
      "visibleRule": "operation != package && connectionType = connectedService:AzureRM",
      "groupName": "authentication"
    },
    {
      "name": "connectionNameGeneric",
      "type": "connectedService:Generic",
      "label": "Generic Connection",
      "required": true,
      "helpMarkDown": "**Generic service connection** for basic authentication (username/password).\n\n**Use case**: On-premises TFS or Azure DevOps Server deployments\n\n**Note**: Not recommended for cloud-hosted Azure DevOps - use PAT authentication instead",
      "visibleRule": "operation != package && connectionType = connectedService:Generic",
      "groupName": "authentication"
    },
    {
      "name": "tfxVersion",
      "type": "string",
      "label": "tfx-cli Version",
      "defaultValue": "built-in",
      "required": false,
      "helpMarkDown": "**Version of tfx-cli to use**:\n\n- **`built-in`** (default): Use tfx-cli bundled with this task\n- **`path`**: Use tfx-cli from system PATH\n- **Version spec**: Download specific version from npm (e.g., `^0.17`, `0.17.0`, `latest`)\n\n**Examples**: `built-in`, `path`, `^0.17`, `latest`",
      "groupName": "advanced"
    },
    {
      "name": "publisherId",
      "type": "string",
      "label": "Publisher ID",
      "required": false,
      "helpMarkDown": "**Publisher ID** that owns the extension.\n\n- Must match publisher in manifest (or override it)\n- Required for all operations except package (if not in manifest)\n- Alphanumeric with hyphens, dots, underscores only\n\n**Example**: `mycompany` or `my-publisher-id`",
      "visibleRule": "operation = package || operation = publish || operation = unpublish || operation = share || operation = unshare || operation = install || operation = show || operation = QueryVersion || operation = waitForValidation || operation = waitForInstallation",
      "groupName": "extensionIdentity"
    },
    {
      "name": "extensionId",
      "type": "string",
      "label": "Extension ID",
      "required": false,
      "helpMarkDown": "**Extension ID** - unique identifier within the publisher namespace.\n\n- Must match ID in manifest (or override it)\n- Combined with Publisher ID forms full extension identifier: `publisherId.extensionId`\n- Required for all operations except package (if not in manifest)\n- Alphanumeric with hyphens, dots, underscores only\n\n**Example**: `my-extension` or `azure-devops-tasks`",
      "visibleRule": "operation = package || operation = publish || operation = unpublish || operation = share || operation = unshare || operation = install || operation = show || operation = QueryVersion || operation = waitForValidation || operation = waitForInstallation",
      "groupName": "extensionIdentity"
    },
    {
      "name": "extensionTag",
      "type": "string",
      "label": "Extension Tag",
      "required": false,
      "helpMarkDown": "**Tag suffix** appended to extension ID for creating variants.\n\n**Use cases**:\n- Create dev/test versions: `-dev`, `-test`\n- Preview releases: `-preview`, `-beta`\n- Branch-specific builds: `-$(Build.SourceBranchName)`\n\n**Example**: If Extension ID is `my-extension` and tag is `-dev`, the actual ID becomes `my-extension-dev`",
      "visibleRule": "operation = package || operation = publish",
      "groupName": "extensionIdentity"
    },
    {
      "name": "publishSource",
      "type": "radio",
      "label": "Publish Source",
      "required": true,
      "defaultValue": "manifest",
      "helpMarkDown": "**Source for publishing**:\n\n- **Manifest files**: Build extension from manifest and source files (typical workflow)\n- **VSIX file**: Publish a pre-built .vsix package\n\n**Use VSIX** when: You've already packaged the extension separately or want to publish an existing .vsix file",
      "visibleRule": "operation = publish",
      "groupName": "publish",
      "options": {
        "manifest": "Manifest files",
        "vsix": "VSIX file"
      }
    },
    {
      "name": "rootFolder",
      "type": "filePath",
      "label": "Root Folder",
      "required": false,
      "helpMarkDown": "**Root folder** containing extension manifest and source files.\n\n- Defaults to repository root if not specified\n- All file paths in manifest are relative to this folder\n- Must contain `vss-extension.json` (or other manifest specified in Manifest Patterns)\n\n**Example**: `$(Build.SourcesDirectory)/src`",
      "visibleRule": "operation = package || (operation = publish && publishSource = manifest) || operation = waitForValidation",
      "groupName": "manifest"
    },
    {
      "name": "localizationRoot",
      "type": "filePath",
      "label": "Localization Root Folder",
      "required": false,
      "helpMarkDown": "**Folder containing localization files** for multi-language support.\n\n- Should contain language-specific resource files\n- Typically structured as: `localization/{locale}/resources.resjson`\n- If not specified, no localization is included\n\n**Example**: `$(Build.SourcesDirectory)/localization`",
      "visibleRule": "operation = package || (operation = publish && publishSource = manifest)",
      "groupName": "manifest"
    },
    {
      "name": "manifestGlobs",
      "type": "multiLine",
      "label": "Manifest Patterns",
      "required": false,
      "helpMarkDown": "**Glob patterns for manifest files** (one per line).\n\n- Defaults to `vss-extension.json` if not specified\n- Can specify multiple patterns for multi-manifest scenarios\n- Patterns are relative to Root Folder\n\n**Examples**:\n- `vss-extension.json` (default)\n- `*.json`\n- `manifests/**/*.json`",
      "visibleRule": "operation = package || (operation = publish && publishSource = manifest) || operation = waitForValidation",
      "groupName": "manifest"
    },
    {
      "name": "vsixFile",
      "type": "filePath",
      "label": "VSIX File",
      "required": true,
      "helpMarkDown": "**Path to pre-built .vsix file** to publish.\n\n- Use when publishing source is 'VSIX file'\n- File must be a valid extension package\n- Supports pipeline variables\n\n**Example**: `$(Build.ArtifactStagingDirectory)/my-extension.vsix`",
      "visibleRule": "operation = publish && publishSource = vsix",
      "groupName": "vsix"
    },
    {
      "name": "extensionVersion",
      "type": "string",
      "label": "Extension Version",
      "required": false,
      "helpMarkDown": "**Override extension version** specified in manifest.\n\n- Must follow semantic versioning: `major.minor.patch`\n- Useful for CI/CD pipelines to inject build numbers\n- Supports pipeline variables\n\n**Examples**:\n- `1.2.3`\n- `$(Build.BuildNumber)`\n- `1.0.$(Build.BuildId)`",
      "visibleRule": "operation = package || operation = publish || operation = install",
      "groupName": "overrides"
    },
    {
      "name": "extensionName",
      "type": "string",
      "label": "Extension Name",
      "required": false,
      "helpMarkDown": "**Override extension display name** shown in marketplace.\n\n- Overrides the name specified in manifest\n- Useful for creating branded variants (e.g., \"My Extension (Dev)\")\n- Does not affect the extension ID\n\n**Example**: `My Extension - Development`",
      "visibleRule": "operation = package || operation = publish",
      "groupName": "overrides"
    },
    {
      "name": "extensionVisibility",
      "type": "pickList",
      "label": "Extension Visibility",
      "required": false,
      "helpMarkDown": "**Override extension visibility** in marketplace.\n\n- **Private**: Only visible to organizations you share it with\n- **Public**: Visible to everyone in the marketplace\n- **Private Preview**: Private extension in preview mode\n- **Public Preview**: Public extension in preview mode\n\n**Note**: Private extensions must be explicitly shared with organizations",
      "visibleRule": "operation = package || operation = publish",
      "groupName": "overrides",
      "options": {
        "private": "Private",
        "public": "Public",
        "private_preview": "Private Preview",
        "public_preview": "Public Preview"
      }
    },
    {
      "name": "extensionPricing",
      "type": "pickList",
      "label": "Extension Pricing",
      "required": false,
      "defaultValue": "default",
      "helpMarkDown": "**Override extension pricing model**.\n\n- **Not set**: Use pricing from manifest\n- **Free**: Extension is free to use\n- **Paid**: Extension requires payment\n\n**Note**: Paid extensions require additional marketplace publisher verification",
      "visibleRule": "operation = package || operation = publish",
      "groupName": "overrides",
      "options": {
        "default": "Not set",
        "free": "Free",
        "paid": "Paid"
      }
    },
    {
      "name": "outputPath",
      "type": "filePath",
      "label": "Output Path",
      "required": false,
      "helpMarkDown": "**Output directory** for generated .vsix file.\n\n- Defaults to current directory if not specified\n- Directory will be created if it doesn't exist\n- The actual filename is based on publisher.extensionId-version.vsix\n\n**Example**: `$(Build.ArtifactStagingDirectory)`\n\n**Output**: Full path is stored in `Extension.OutputPath` variable",
      "visibleRule": "operation = package",
      "groupName": "advanced"
    },
    {
      "name": "outputVariable",
      "type": "string",
      "label": "Output Variable",
      "required": false,
      "helpMarkDown": "**Name of pipeline variable** to store operation result.\n\n**Package operation**: Stores path to generated .vsix file\n**Show operation**: Stores JSON metadata about the extension\n\n**Usage example**:\n```yaml\n- task: ExtensionTasks@6\n  name: PackageStep\n  inputs:\n    operation: package\n    outputVariable: VsixPath\n\n- script: echo $(VsixPath)\n```",
      "visibleRule": "operation = package || operation = show || operation = QueryVersion",
      "groupName": "advanced"
    },
    {
      "name": "versionAction",
      "type": "pickList",
      "label": "Version Action",
      "required": false,
      "defaultValue": "None",
      "helpMarkDown": "**Action to apply to the marketplace version**.\n\n- **None**: Use the current latest marketplace version\n- **Major**: Increment major and reset minor/patch\n- **Minor**: Increment minor and reset patch\n- **Patch**: Increment patch\n\n**Example**: If latest is `1.2.3` and action is `Minor`, result is `1.3.0`",
      "visibleRule": "operation = QueryVersion",
      "groupName": "advanced",
      "options": {
        "None": "None - Keep current version",
        "Major": "Major - Increment major",
        "Minor": "Minor - Increment minor",
        "Patch": "Patch - Increment patch"
      }
    },
    {
      "name": "extensionVersionOverride",
      "type": "string",
      "label": "Version Override Variable",
      "required": false,
      "helpMarkDown": "**Variable name containing a version override**.\n\nIf set and the variable exists, that value is used instead of querying marketplace.\n\n**Example**: `MyVersionVar` (where `$(MyVersionVar)` resolves to `2.1.0`)",
      "visibleRule": "operation = QueryVersion",
      "groupName": "advanced"
    },
    {
      "name": "setBuildNumber",
      "type": "boolean",
      "label": "Set Build Number",
      "required": false,
      "defaultValue": "false",
      "helpMarkDown": "**Update the Azure Pipelines build number** to the resolved version.\n\n**Default**: false",
      "visibleRule": "operation = QueryVersion",
      "groupName": "advanced"
    },
    {
      "name": "bypassValidation",
      "type": "boolean",
      "label": "Bypass Validation",
      "required": false,
      "defaultValue": "false",
      "helpMarkDown": "**Skip extension validation checks** during package/publish.\n\n- Not recommended for production use\n- Use only when validation incorrectly fails\n- May result in extension rejection by marketplace\n\n**Default**: false (validation enabled)",
      "visibleRule": "operation = package || operation = publish",
      "groupName": "validation"
    },
    {
      "name": "revVersion",
      "type": "boolean",
      "label": "Auto-increment Version",
      "required": false,
      "defaultValue": "false",
      "helpMarkDown": "**Automatically increment the patch version** of the extension.\n\n- Increments the last digit: `1.2.3` → `1.2.4`\n- Applied before packaging\n- Useful for automated builds\n\n**Note**: Does not modify source manifest file, only the packaged version\n\n**Default**: false",
      "visibleRule": "operation = package",
      "groupName": "advanced"
    },
    {
      "name": "shareWith",
      "type": "multiLine",
      "label": "Share With",
      "required": false,
      "helpMarkDown": "**Organizations to share the extension with** (one per line).\n\n- Required for private extensions\n- Format: organization name only (not full URL)\n- Organizations must exist in Azure DevOps\n\n**Examples**:\n```\nmyorg1\nmyorg2\ncontoso\n```\n\n**Note**: Extension must be private to use sharing",
      "visibleRule": "(operation = publish && (extensionVisibility = private || extensionVisibility = private_preview || extensionVisibility = default)) || operation = share",
      "groupName": "sharing"
    },
    {
      "name": "unshareWith",
      "type": "multiLine",
      "label": "Unshare With",
      "required": false,
      "helpMarkDown": "**Organizations to unshare the extension from** (one per line).\n\n- Removes extension access from specified organizations\n- Format: organization name only (not full URL)\n- Organizations will no longer see or use the extension\n\n**Examples**:\n```\noldorg1\noldorg2\n```",
      "visibleRule": "operation = unshare",
      "groupName": "sharing"
    },
    {
      "name": "accounts",
      "type": "multiLine",
      "label": "Accounts",
      "required": true,
      "helpMarkDown": "**Azure DevOps accounts/organizations** to install extension to (one per line).\n\n- Format: Full organization URL or organization name\n- Organizations must have access to the extension (shared if private)\n- Requires organization administrator permissions\n\n**Examples**:\n```\nhttps://dev.azure.com/myorg1\nhttps://dev.azure.com/myorg2\n```\n\nOr just:\n```\nmyorg1\nmyorg2\n```",
      "visibleRule": "operation = install || operation = waitForInstallation",
      "groupName": "sharing"
    },
    {
      "name": "noWaitValidation",
      "type": "boolean",
      "label": "No Wait for Validation",
      "required": false,
      "defaultValue": "false",
      "helpMarkDown": "**Do not wait for marketplace validation** to complete after publishing.\n\n- By default, task waits for validation (can take several minutes)\n- Enable this to publish and continue immediately\n- Extension may not be immediately available in marketplace\n\n**Use case**: When you want faster pipeline execution and don't need immediate marketplace availability\n\n**Default**: false (waits for validation)",
      "visibleRule": "operation = publish",
      "groupName": "validation"
    },
    {
      "name": "updateTasksVersion",
      "type": "boolean",
      "label": "Update Task Versions",
      "required": false,
      "defaultValue": "false",
      "helpMarkDown": "**Automatically update task versions** within the extension to match the extension version.\n\n- Updates all task.json files in the extension\n- Controlled by 'Update Tasks Version Type' setting\n- Useful for keeping task and extension versions in sync\n\n**Example**: If extension version is `2.5.8` and version type is 'major':\n- Task version `1.0.0` becomes `2.5.8`\n- Task version `3.1.4` becomes `2.5.8`\n\n**Default**: false",
      "visibleRule": "operation = package || operation = publish",
      "groupName": "advanced"
    },
    {
      "name": "updateTasksVersionType",
      "type": "pickList",
      "label": "Update Tasks Version Type",
      "required": false,
      "defaultValue": "major",
      "helpMarkDown": "**Specify which parts of task versions to update**:\n\n- **Replace Major, Minor, Patch (x.y.r)**: Replace all three parts with extension version\n- **Replace Minor, Patch (1.y.r)**: Keep major version, replace minor and patch\n- **Replace Only Patch (1.0.r)**: Keep major and minor, replace only patch\n\n**Example with extension version `2.5.8`**:\n- Task `1.3.7` with **Major** → `2.5.8`\n- Task `1.3.7` with **Minor** → `1.5.8`\n- Task `1.3.7` with **Patch** → `1.3.8`\n\n**Default**: Replace Major, Minor, Patch",
      "visibleRule": "updateTasksVersion = true && (operation = package || operation = publish)",
      "groupName": "advanced",
      "options": {
        "major": "Replace Major, Minor, Patch (x.y.r)",
        "minor": "Replace Minor, Patch (1.y.r)",
        "patch": "Replace Only Patch (1.0.r)"
      }
    },
    {
      "name": "updateTasksId",
      "type": "boolean",
      "label": "Update Task IDs",
      "required": false,
      "defaultValue": "false",
      "helpMarkDown": "**Generate new deterministic task IDs** for all tasks in the extension.\n\n- Creates UUID v5 IDs based on publisher + extension + task name\n- Ensures consistent IDs across builds\n- Use when creating extension variants (e.g., dev, test versions)\n\n**Warning**: Changing task IDs creates new tasks in Azure DevOps. Existing pipelines won't automatically update.\n\n**Use case**: Creating parallel development/production versions of the same extension\n\n**Default**: false",
      "visibleRule": "operation = package || operation = publish",
      "groupName": "advanced"
    },
    {
      "name": "maxRetries",
      "type": "string",
      "label": "Max Retries",
      "required": false,
      "defaultValue": "10",
      "helpMarkDown": "**Maximum number of retry attempts** for extension validation.\n\n- Validation can take time as marketplace processes the extension\n- Task will retry with exponential backoff between min and max timeout\n- Set higher for complex extensions that take longer to validate\n\n**Default**: 10 attempts",
      "visibleRule": "operation = waitForValidation",
      "groupName": "validation"
    },
    {
      "name": "minTimeout",
      "type": "string",
      "label": "Min Timeout (minutes)",
      "required": false,
      "defaultValue": "1",
      "helpMarkDown": "**Minimum timeout between validation retry attempts** (in minutes).\n\n- Initial wait time before first retry\n- Increases exponentially up to max timeout\n- Lower values check validation status more frequently\n\n**Default**: 1 minute",
      "visibleRule": "operation = waitForValidation",
      "groupName": "validation"
    },
    {
      "name": "maxTimeout",
      "type": "string",
      "label": "Max Timeout (minutes)",
      "required": false,
      "defaultValue": "15",
      "helpMarkDown": "**Maximum timeout between validation retry attempts** (in minutes).\n\n- Maximum wait time between retry attempts\n- Timeout increases exponentially from min timeout\n- Higher values give extension more time to validate\n\n**Default**: 15 minutes",
      "visibleRule": "operation = waitForValidation",
      "groupName": "validation"
    },
    {
      "name": "expectedTasks",
      "type": "multiLine",
      "label": "Expected Tasks (JSON)",
      "required": false,
      "helpMarkDown": "**Expected tasks as JSON array** - manually specify tasks to verify.\n\n**Format**: Array of objects with `name` and `versions` properties\n\n**Example**:\n```json\n[\n  {\"name\": \"MyTask\", \"versions\": [\"1.0.0\", \"1.0.1\"]},\n  {\"name\": \"AnotherTask\", \"versions\": [\"2.0.0\"]}\n]\n```\n\n**Note**: Use this OR auto-discovery options (manifest-path/vsix-path), not both",
      "visibleRule": "operation = waitForInstallation",
      "groupName": "validation"
    },
    {
      "name": "manifestPath",
      "type": "filePath",
      "label": "Manifest Path",
      "required": false,
      "helpMarkDown": "**Path to extension manifest** for auto-discovering task versions.\n\n- Reads manifest to find all tasks and their versions\n- More convenient than manually specifying expected tasks\n- File must be a valid vss-extension.json\n\n**Example**: `$(Build.SourcesDirectory)/vss-extension.json`\n\n**Note**: Use this OR expected-tasks/vsix-path, not multiple options",
      "visibleRule": "operation = waitForInstallation",
      "groupName": "validation"
    },
    {
      "name": "vsixPath",
      "type": "filePath",
      "label": "VSIX Path",
      "required": false,
      "helpMarkDown": "**Path to .vsix file** for auto-extracting and discovering task versions.\n\n- Extracts task.json files from VSIX package\n- Automatically determines which tasks and versions to verify\n- Most convenient when verifying immediately after packaging\n\n**Example**: `$(Build.ArtifactStagingDirectory)/my-extension.vsix`\n\n**Note**: Use this OR expected-tasks/manifest-path, not multiple options",
      "visibleRule": "operation = waitForInstallation",
      "groupName": "validation"
    },
    {
      "name": "timeoutMinutes",
      "type": "string",
      "label": "Timeout (minutes)",
      "required": false,
      "defaultValue": "10",
      "helpMarkDown": "**Maximum time to wait** for tasks to become available after installation (in minutes).\n\n- Task polls Azure DevOps at regular intervals\n- If tasks don't appear within timeout, verification fails\n- Increase for slower marketplace propagation\n\n**Default**: 10 minutes",
      "visibleRule": "operation = waitForInstallation",
      "groupName": "validation"
    },
    {
      "name": "pollingIntervalSeconds",
      "type": "string",
      "label": "Polling Interval (seconds)",
      "required": false,
      "defaultValue": "30",
      "helpMarkDown": "**Interval between task availability checks** (in seconds).\n\n- How often to check if tasks are available\n- Lower values detect availability faster but create more API calls\n- Higher values reduce API load but delay detection\n\n**Recommendation**: 30-60 seconds is usually sufficient\n\n**Default**: 30 seconds",
      "visibleRule": "operation = waitForInstallation",
      "groupName": "validation"
    }
  ],
  "outputVariables": [
    {
      "name": "Extension.OutputPath",
      "description": "Path to the generated .vsix file (package operation only)"
    },
    {
      "name": "Extension.Metadata",
      "description": "JSON metadata about the extension (show operation only)"
    },
    {
      "name": "Extension.ProposedVersion",
      "description": "Proposed extension version after applying version action (query-version operation only)"
    },
    {
      "name": "Extension.CurrentVersion",
      "description": "Current marketplace version before applying version action (query-version operation only)"
    },
    {
      "name": "Extension.Published",
      "description": "Whether the extension was published (true/false, publish operation only)"
    },
    {
      "name": "Extension.Shared",
      "description": "Whether the extension was shared (true/false, share operation only)"
    },
    {
      "name": "Extension.Unshared",
      "description": "Whether the extension was unshared (true/false, unshare operation only)"
    },
    {
      "name": "Extension.Installed",
      "description": "Whether the extension was installed (true/false, install operation only)"
    },
    {
      "name": "Extension.WaitForValidation",
      "description": "Whether the extension passed validation (true/false, wait-for-validation operation only)"
    },
    {
      "name": "Extension.WaitForInstallation",
      "description": "Whether installation verification succeeded (true/false, wait-for-installation operation only)"
    }
  ],
  "execution": {
    "Node20_1": {
      "target": "dist/main.js"
    }
  }
}